<div class="history">
  <h3 class="muted">Trade History</h3>
  <ng-container *ngIf="!loading; else loadingTpl">
    <table class="panel" *ngIf="rows.length; else emptyTpl">
      <thead>
        <tr>
          <th>Time</th>
          <th>Price</th>
          <th>Change</th>
          <th>Amount</th>
          <th>Fee</th>
          <th>Tx</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let r of rows">
          <td>{{ r.ts | date:'HH:mm:ss' }}</td>
          <td>
            <span class="pill" style="margin-right:4px" *ngIf="r.optionType">{{ r.optionType }} {{ r.strike }}</span>
            {{ r.ltp | number:'1.2-2' }}
          </td>
          <td>
            <span class="delta" [ngClass]="{up: r.changePct > 0, down: r.changePct < 0}">
              {{ r.changePct > 0 ? '+' : '' }}{{ r.changePct.toFixed(2) }}%
            </span>
          </td>
          <td>{{ r.qty }}</td>
          <td>—</td>
          <td title="{{ r.txId }}">{{ r.txId.slice(-6) }}</td>
          <td class="kebab">⋮</td>
        </tr>
      </tbody>
    </table>
    <ng-template #emptyTpl>
      <div class="panel" style="text-align:center; padding:24px">No trades yet</div>
    </ng-template>
  </ng-container>
  <ng-template #loadingTpl>
    <div class="panel" style="text-align:center; padding:24px">Loading...</div>
  </ng-template>
</div>
